<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Yann Bot Po√®me</title>
  <!-- Ajout de html2canvas pour la fonction savePoem -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      background: linear-gradient(135deg, #ff6bd6, #00f4ff);
      color: #fff;
      transition: all 0.5s ease;
      overflow-x: hidden;
    }

    /* Th√®mes de fond */
    .theme-gradient { background: linear-gradient(135deg, #ff6bd6, #00f4ff); }
    .theme-waves { background: linear-gradient(135deg, #6bd6ff, #00aaff); }
    .theme-stars { background: linear-gradient(135deg, #1a1a40, #2a2a80); }
    .theme-clouds { background: linear-gradient(135deg, #f0f8ff, #b3e5fc); }
    .theme-aurora { background: linear-gradient(135deg, #0d1b2a, #1e3a8a); }
    .theme-fireflies { background: linear-gradient(135deg, #1c2526, #2e4a4f); }
    .theme-rain { background: linear-gradient(135deg, #b0c4de, #4682b4); }
    .theme-galaxy { background: linear-gradient(135deg, #0a0a23, #4b0082); }
    .theme-sunset { background: linear-gradient(135deg, #ffecd1, #ff4500); }
    .theme-forest { background: linear-gradient(135deg, #013220, #228b22); }
    .high-contrast { filter: contrast(1.5); background: #000; color: #fff; }

    /* Bouton pour ouvrir le tiroir */
    .menu-btn {
      position: fixed;
      top: 20px;
      left: 20px;
      font-size: 24px;
      background: linear-gradient(45deg, #ff1493, #00b7eb);
      color: #fff;
      border: none;
      padding: 10px 15px;
      border-radius: 8px;
      cursor: pointer;
      z-index: 1001;
      box-shadow: 0 0 15px rgba(255, 20, 147, 0.7);
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .menu-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 0 20px rgba(255, 20, 147, 1), 0 0 30px rgba(0, 183, 235, 1);
    }

    /* Bouton point d'interrogation */
    .info-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      font-size: 20px;
      background: linear-gradient(45deg, #ff1493, #00b7eb);
      color: #fff;
      border: none;
      padding: 10px 15px;
      border-radius: 50%;
      cursor: pointer;
      z-index: 1001;
      box-shadow: 0 0 15px rgba(255, 20, 147, 0.7);
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .info-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 0 20px rgba(255, 20, 147, 1), 0 0 30px rgba(0, 183, 235, 1);
    }

    /* Tiroir de navigation */
    .nav-drawer {
      position: fixed;
      top: 0;
      left: -300px;
      width: 300px;
      height: 100%;
      background: linear-gradient(135deg, #ff00cc, #00ffcc, #ff00cc);
      color: #fff;
      padding: 20px;
      transition: left 0.4s ease;
      z-index: 1000;
      box-shadow: 2px 0 15px rgba(255, 0, 204, 0.9);
      animation: neonGlow 1.5s infinite alternate;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .nav-drawer.open {
      left: 0;
    }
    @keyframes neonGlow {
      0% { box-shadow: 0 0 20px rgba(255, 0, 204, 0.9), 0 0 30px rgba(0, 255, 204, 0.9); }
      100% { box-shadow: 0 0 30px rgba(255, 0, 204, 1), 0 0 40px rgba(0, 255, 204, 1); }
    }

    .nav-drawer h2 {
      font-size: 24px;
      margin-bottom: 15px;
      text-align: center;
      color: #fff;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
    }

    .nav-drawer input, .nav-drawer select, .nav-drawer button {
      padding: 10px;
      font-size: 14px;
      border-radius: 8px;
      border: none;
      background: linear-gradient(45deg, #ff1493, #00b7eb);
      color: #fff;
      cursor: pointer;
      transition: transform 0.3s, box-shadow 0.3s;
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
    }
    .nav-drawer input:hover, .nav-drawer select:hover, .nav-drawer button:hover {
      transform: scale(1.05);
      box-shadow: 0 0 15px rgba(255, 20, 147, 1), 0 0 20px rgba(0, 183, 235, 1);
    }

    /* Fond sombre pour l'overlay */
    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      display: none;
      z-index: 999;
    }
    .overlay.active {
      display: block;
    }

    /* Canvas */
    canvas {
      max-width: 90%;
      max-height: 60vh;
      border: 2px solid #fff;
      border-radius: 10px;
      margin: 20px 0;
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
    }

    /* Animation d'entr√©e */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .poem-text { animation: fadeIn 1s ease-in; }

    /* Footer */
    footer {
      position: fixed;
      bottom: 10px;
      font-size: 12px;
      color: #fff;
      text-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
    }
    footer a {
      color: #00ffcc;
      text-decoration: none;
    }
    footer a:hover {
      text-decoration: underline;
    }

    /* Modal profil */
    #profileModal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    #profileModal div {
      background: linear-gradient(135deg, #ff00cc, #00ffcc, #ff00cc);
      padding: 20px;
      border-radius: 12px;
      max-width: 90%;
      width: 400px;
      box-shadow: 0 0 30px rgba(255, 0, 204, 0.9);
      animation: neonGlow 1.5s infinite alternate;
    }
    #profileModal h2 {
      color: #fff;
      text-align: center;
      margin-top: 0;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
    }
    #profileModal button, #profileModal input {
      padding: 10px;
      font-size: 14px;
      border-radius: 8px;
      border: none;
      background: linear-gradient(45deg, #ff1493, #00b7eb);
      color: #fff;
      cursor: pointer;
      transition: transform 0.3s, box-shadow 0.3s;
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
      width: 100%;
      margin-bottom: 10px;
    }
    #profileModal button:hover, #profileModal input:hover {
      transform: scale(1.05);
      box-shadow: 0 0 15px rgba(255, 20, 147, 1), 0 0 20px rgba(0, 183, 235, 1);
    }
    #profilePreview {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      margin: 0 auto;
      display: block;
      border: 2px solid #fff;
    }
    #cameraStream {
      width: 100%;
      max-height: 200px;
    }
    #profileDisplay img {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      vertical-align: middle;
      margin-right: 5px;
      border: 1px solid #fff;
    }

    /* Modal Info */
    #infoModal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    #infoModal div {
      background: linear-gradient(135deg, #ff00cc, #00ffcc, #ff00cc);
      padding: 20px;
      border-radius: 12px;
      max-width: 90%;
      width: 400px;
      box-shadow: 0 0 30px rgba(255, 0, 204, 0.9);
      animation: neonGlow 1.5s infinite alternate;
    }
    #infoModal h2 {
      color: #fff;
      text-align: center;
      margin-top: 0;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
    }
    #infoModal p {
      color: #fff;
      font-size: 14px;
      line-height: 1.5;
      margin-bottom: 15px;
    }
    #infoModal button {
      padding: 10px;
      font-size: 14px;
      border-radius: 8px;
      border: none;
      background: linear-gradient(45deg, #ff1493, #00b7eb);
      color: #fff;
      cursor: pointer;
      transition: transform 0.3s, box-shadow 0.3s;
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
      width: 100%;
    }
    #infoModal button:hover {
      transform: scale(1.05);
      box-shadow: 0 0 15px rgba(255, 20, 147, 1), 0 0 20px rgba(0, 183, 235, 1);
    }

    /* Responsivit√© */
    @media (max-width: 600px) {
      .nav-drawer { width: 80%; }
      .nav-drawer input, .nav-drawer select, .nav-drawer button { font-size: 12px; }
      #profileModal div, #infoModal div { width: 90%; }
      #profileModal input, #profileModal button, #infoModal button { font-size: 12px; }
    }
  </style>
</head>
<body class="theme-gradient">
  <h1 style="font-size: 1.3em; margin: 20px; text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);">Po√®mes Yann Bot</h1>
  
  <!-- Bouton pour ouvrir le tiroir -->
  <button class="menu-btn" onclick="toggleDrawer()" aria-label="Ouvrir le menu">‚ò∞</button>
  
  <!-- Bouton point d'interrogation -->
  <button class="info-btn" onclick="openInfoModal()" aria-label="Ouvrir les informations">?</button>

  <!-- Tiroir de navigation -->
  <div class="nav-drawer" id="drawer">
    <h2>Param√®tres</h2>
    <input type="text" id="keyword" placeholder="Mot-cl√© (ex. Amour)" aria-label="Mot-cl√© pour le po√®me">
    <select id="themeSelector" aria-label="Fond">
      <option value="gradient">D√©grad√©</option>
      <option value="waves">Vagues</option>
      <option value="stars">√âtoiles</option>
      <option value="clouds">Nuages</option>
      <option value="aurora">Aurores</option>
      <option value="fireflies">Lucioles</option>
      <option value="rain">Pluie</option>
      <option value="galaxy">Galaxie</option>
      <option value="sunset">Coucher de Soleil</option>
      <option value="forest">For√™t</option>
    </select>
    <select id="domainSelector" aria-label="Domaine">
      <option value="amour">Amour</option>
      <option value="nature">Nature</option>
      <option value="aventure">Aventure</option>
      <option value="melancolie">M√©lancolie</option>
      <option value="espoir">Espoir</option>
      <option value="technologie">Technologie</option>
      <option value="liberte">Libert√©</option>
    </select>
    <button onclick="generatePoem()" aria-label="G√©n√©rer">G√©n√©rer</button>
    <button onclick="toggleHighContrast()" aria-label="Contraste">Contraste</button>
    <button onclick="exportImage()" aria-label="Exporter">Exporter</button>
    <button onclick="sharePoem()" aria-label="Partager">Partager</button>
    <button onclick="copyPoem()" aria-label="Copier le po√®me">Copier</button>
    <button onclick="savePoem()" aria-label="Sauvegarder en image">Sauvegarder en image</button>
    <button onclick="openProfileModal()" aria-label="Ouvrir le profil">Profil</button>
    <button onclick="openInfoModal()" aria-label="Ouvrir les informations">Info</button>
  </div>

  <!-- Fond sombre pour l'overlay -->
  <div class="overlay" id="overlay" onclick="toggleDrawer()"></div>

  <!-- Canvas -->
  <canvas id="canvas" class="poem-text"></canvas>

  <!-- Modal pour le profil -->
  <div id="profileModal" style="display: none;">
    <div>
      <h2>Votre Profil</h2>
      <input type="text" id="profileName" placeholder="Votre nom !" aria-label="Nom du profil">
      <div style="text-align: center; margin-bottom: 10px;">
        <img id="profilePreview" src="" alt="Aper√ßu de la photo de profil" style="display: none;">
      </div>
      <input type="file" id="profilePhoto" accept="image/*" aria-label="Uploader une photo">
      <button onclick="takePhoto()" aria-label="Prendre une photo">Prendre une photo</button>
      <video id="cameraStream" style="display: none;"></video>
      <canvas id="photoCanvas" style="display: none;"></canvas>
      <div style="text-align: center;">
        <button onclick="saveProfile()" aria-label="Sauvegarder le profil">Sauvegarder</button>
        <button onclick="closeProfileModal()" aria-label="Fermer le profil">Fermer</button>
      </div>
    </div>
  </div>

  <!-- Modal pour les informations -->
  <div id="infoModal" style="display: none;">
    <div>
      <h2>Comment utiliser le G√©n√©rateur de Po√®mes</h2>
      <p>
        Bienvenue dans le G√©n√©rateur de Po√®mes Yann Bot ! Suivez ces √©tapes pour cr√©er votre po√®me visuel :
        <ol>
          <li><b>Ouvrez le tiroir</b> : Cliquez sur l‚Äôic√¥ne ‚ò∞ ou glissez depuis le bord gauche (sur mobile).</li>
          <li><b>Entrez un mot-cl√©</b> : Tapez un nom (ex."Andr√©a") pour inspirer le po√®me.et le po√®me seras fait expr√®s pour cette personne üí´</li>
          <li><b>Choisissez un th√®me</b> : S√©lectionnez un fond visuel (ex. "√âtoiles", "Vagues").</li>
          <li><b>Choisissez un domaine</b> : S√©lectionnez un th√®me po√©tique (ex. "Amour", "Nature").</li>
          <li><b>G√©n√©rez</b> : Cliquez sur "G√©n√©rer" pour cr√©er votre po√®me.</li>
          <li><b>Personnalisez</b> : Utilisez "Contraste" pour ajuster la lisibilit√©, ou acc√©dez √† "Profil" pour ajouter votre nom et photo.</li>
          <li><b>Exportez/Partagez</b> : Utilisez "Exporter" pour sauvegarder l‚Äôimage, "Partager" pour diffuser, ou "Copier" pour le texte.</li>
        </ol>
        Amusez-vous √† cr√©er des po√®mes uniques avec Yann Bot ! üçÅü•Äüåπ
      </p>
      <button onclick="closeInfoModal()" aria-label="Fermer les informations">Fermer</button>
    </div>
  </div>

  <footer>
    <span id="profileDisplay"></span>
    ¬© 2025 G√©n√©rateur de Po√®mes Visuels. Par Yann Bot | <a href="#">Mentions l√©gales üçÅü•ÄüåπYANN BOT!!!!üçÅü•Äüåπ</a>
  </footer>

  <script>
    // JavaScript pour g√©rer le tiroir
    let isDragging = false;
    let startX;

    function toggleDrawer() {
      const drawer = document.getElementById('drawer');
      const overlay = document.getElementById('overlay');
      drawer.classList.toggle('open');
      overlay.classList.toggle('active');
    }

    document.addEventListener('touchstart', (e) => {
      startX = e.touches[0].clientX;
      isDragging = startX < 50;
    });

    document.addEventListener('touchmove', (e) => {
      if (!isDragging) return;
      const currentX = e.touches[0].clientX;
      const diffX = currentX - startX;
      if (diffX > 50) {
        toggleDrawer();
        isDragging = false;
      }
    });

    document.addEventListener('touchend', () => {
      isDragging = false;
    });

    // Fonctions pour le modal Info
    function openInfoModal() {
      document.getElementById('infoModal').style.display = 'flex';
      if (document.getElementById('drawer').classList.contains('open')) {
        toggleDrawer();
      }
    }

    function closeInfoModal() {
      document.getElementById('infoModal').style.display = 'none';
    }

    // Po√®mes complets (corrig√©s)
    const poemTemplates = {
      amour: [
        ["Dans l‚Äô√©clat {keyword}, le c≈ìur s‚Äô√©veille,", "Sous un ciel d‚Äô√©toiles, l‚Äô√¢me s‚Äôengage,", "Chaque battement murmure ton nom,", "Dans un souffle, l‚Äôamour se prolonge.", "Oh {keyword}, lumi√®re des jours,", "Tu guides mes r√™ves pour toujours."],
        ["{keyword} danse au fond de mes yeux,", "Comme un feu doux sous les cieux,", "Nos mains li√©es, le temps s‚Äôefface,", "Dans l‚Äô√©treinte, plus rien ne glace.", "Ton sourire, un √©ternel printemps,", "Porte mon c≈ìur dans l‚Äôinstant."],
        ["Sous l‚Äôombre tendre de {keyword},", "Les √¢mes s‚Äôunissent, loin des haines,", "Un regard suffit √† tout changer,", "Dans ce lien, le monde peut s‚Äôeffacer.", "Oh {keyword}, doux secret partag√©,", "Tu es ma flamme, mon √©ternit√©."],
        ["{keyword} brille comme un phare,", "Dans la nuit, il guide mes pas,", "Chaque mot d‚Äôamour, une caresse,", "Chaque silence, une promesse.", "Avec toi, le c≈ìur ne craint rien,", "Car {keyword} est notre chemin."],
        ["Dans les plis du vent, {keyword} chante,", "Une m√©lodie douce et vivante,", "Nos √¢mes s‚Äôentrelacent sans fin,", "Comme des √©toiles dans le destin.", "Oh {keyword}, √©clat de mes nuits,", "Tu rends la vie plus infinie."],
        ["{keyword} est un feu qui ne s‚Äô√©teint,", "Dans le froid, il toujours √©treint,", "Chaque instant avec toi est un po√®me,", "Une histoire d‚Äôamour que j‚Äôaime.", "Sous ton regard, le monde s‚Äôefface,", "Et l‚Äô√©ternit√© prend sa place."],
        ["Oh {keyword}, souffle de mon c≈ìur,", "Tu portes en toi tant de chaleur,", "Dans tes bras, le temps s‚Äôarr√™te,", "Chaque seconde est une f√™te.", "Avec {keyword}, tout devient lumi√®re,", "Un amour plus vaste que la mer."],
      ],
      nature: [
        ["Sous l‚Äôombre de {keyword}, la for√™t murmure,", "Les feuilles dansent avec la nature,", "Le vent caresse les cimes alti√®res,", "Et la terre chante ses pri√®res.", "Oh {keyword}, souffle de vie,", "Tu portes l‚Äô√¢me de l‚Äôinfini."],
        ["{keyword} brille dans l‚Äôaube claire,", "Sur les champs o√π la ros√©e √©claire,", "Les rivi√®res chantent en √©cho,", "Sous le ciel, tout semble si beau.", "Dans ton √©clat, la terre respire,", "Et la vie ne cesse de s‚Äô√©crire."],
        ["Dans la brise, {keyword} s‚Äô√©l√®ve,", "Comme un oiseau libre qui r√™ve,", "Les montagnes veillent en silence,", "La nature offre sa pr√©sence.", "Oh {keyword}, force √©ternelle,", "Tu es la voix qui m‚Äôappelle."],
        ["{keyword} coule comme une rivi√®re,", "Dans ses flots, plus rien ne m‚Äôop√®re,", "Les arbres dansent sous le soleil,", "Chaque feuille est un doux r√©veil.", "Dans ton calme, je trouve la paix,", "Et la nature m‚Äôouvre ses plais."],
        ["Sous le ciel, {keyword} s‚Äô√©tend,", "Comme un oc√©an de verts champs,", "Les fleurs s‚Äôouvrent √† l‚Äôhorizon,", "Et chantent leur douce chanson.", "Oh {keyword}, √©clat de la terre,", "Tu rends le c≈ìur l√©ger, sinc√®re."],
        ["{keyword} murmure dans la plaine,", "Sous la lune, loin de toute peine,", "Les √©toiles veillent sur les bois,", "Et la nuit s‚Äôemplit de ta voix.", "Dans ton souffle, je vois l‚Äô√©clat,", "De la nature qui ne meurt pas."],
        ["Dans l‚Äôombre douce de {keyword},", "La terre bat comme un grand c≈ìur,", "Les ruisseaux dansent avec la brise,", "Et la vie s‚Äô√©veille, pr√©cise.", "Oh {keyword}, miroir des cieux,", "Tu rends le monde plus radieux."],
      ],
      aventure: [
        ["{keyword} guide mes pas audacieux,", "Vers des terres sous des cieux nouveaux,", "Les sentiers s‚Äôouvrent, pleins de myst√®re,", "Chaque pas d√©fie la fronti√®re.", "Oh {keyword}, flamme du voyage,", "Tu portes mon c≈ìur au sauvage."],
        ["Dans l‚Äô√©clat de {keyword}, je pars,", "Vers l‚Äôhorizon, loin des remparts,", "Les vents hurlent, les mers appellent,", "Et l‚Äô√¢me brave les vagues rebelles.", "Avec {keyword}, tout est possible,", "Chaque d√©fi rend l‚Äô√¢me invincible."],
        ["{keyword} chante dans la temp√™te,", "Un appel que rien n‚Äôarr√™te,", "Montagnes, d√©serts, for√™ts profondes,", "Le monde s‚Äôouvre, libre et immonde.", "Oh {keyword}, √©toile des braves,", "Tu guides ceux que rien n‚Äôentrave."],
        ["Sous l‚Äôombre de {keyword}, j‚Äôavance,", "Dans la nuit, plein d‚Äôesp√©rance,", "Les √©toiles tracent mon chemin,", "Vers des r√™ves qui n‚Äôont pas de fin.", "Avec {keyword}, le c≈ìur s‚Äô√©lance,", "Pour une vie pleine d‚Äôerrance."],
        ["{keyword} brille comme un flambeau,", "Dans les terres o√π nul n‚Äôest trop t√¥t,", "Chaque pas r√©v√®le un nouveau monde,", "Chaque instant rend l‚Äô√¢me plus profonde.", "Oh {keyword}, souffle d‚Äô√©pop√©e,", "Tu fais na√Ætre l‚Äô√¢me exalt√©e."],
        ["Dans le vent, {keyword} m‚Äôappelle,", "Vers des cimes, des mers cruelles,", "Le danger danse, mais je ris,", "Car l‚Äôaventure est mon pays.", "Avec {keyword}, je suis vivant,", "Libre dans l‚Äôinstant triomphant."],
        ["{keyword} est une flamme vive,", "Qui pousse l‚Äô√¢me √† la d√©rive,", "Sur des chemins o√π tout s‚Äôinvente,", "Chaque jour est une attente.", "Oh {keyword}, guide des intr√©pides,", "Tu rends la vie moins aride."],
      ],
      melancolie: [
        ["Dans l‚Äôombre de {keyword}, je erre,", "Sous un ciel lourd, loin de la terre,", "Les souvenirs dansent dans la brume,", "Et le c≈ìur s‚Äô√©teint dans l‚Äô√©cume.", "Oh {keyword}, √©cho du pass√©,", "Tu portes l‚Äô√¢me des effac√©s."],
        ["{keyword} murmure dans le silence,", "Un chant doux, plein de souvenance,", "Les jours perdus s‚Äôeffacent lentement,", "Dans le vent, tout semble si lent.", "Avec {keyword}, le c≈ìur s‚Äô√©gare,", "Dans des r√™ves que rien n‚Äô√©gale."],
        ["Sous la pluie, {keyword} s‚Äôefface,", "Comme une ombre que le temps glace,", "Chaque pas r√©sonne dans le vide,", "Et l‚Äô√¢me reste toujours avide.", "Oh {keyword}, miroir des regrets,", "Tu peins la vie en tons discrets."],
        ["{keyword} chante une vieille rengaine,", "Dans la nuit, loin de toute haleine,", "Les √©toiles pleurent en silence,", "Et le c≈ìur s‚Äôemplit d‚Äôabsence.", "Avec {keyword}, tout semble fini,", "Mais la peine garde sa vie."],
        ["Dans le froid, {keyword} s‚Äô√©teint,", "Comme un feu que la nuit atteint,", "Les jours d‚Äôantan s‚Äôeffacent en douceur,", "Laissant l‚Äô√¢me pleine de langueur.", "Oh {keyword}, souffle du n√©ant,", "Tu portes l‚Äô√©cho des instants."],
        ["{keyword} est une larme cach√©e,", "Dans le c≈ìur, une plaie us√©e,", "Les souvenirs s‚Äôeffacent dans l‚Äôombre,", "Et le temps rend tout plus sombre.", "Avec {keyword}, je marche seul,", "Sous un ciel voil√© d‚Äôun linceul."],
        ["Sous l‚Äô√©clat p√¢le de {keyword},", "Le monde semble loin, perdu,", "Chaque souffle est un adieu discret,", "Chaque pas un poids qui m‚Äôarr√™te.", "Oh {keyword}, ombre des jours pass√©s,", "Tu berces l‚Äô√¢me des lass√©s."],
      ],
      espoir: [
        ["Dans la lumi√®re de {keyword}, je vois,", "Un chemin clair, loin des effrois,", "Chaque pas porte un nouveau r√™ve,", "Et l‚Äô√¢me s‚Äô√©l√®ve, si br√®ve.", "Oh {keyword}, √©clat d‚Äôavenir,", "Tu fais na√Ætre l‚Äôenvie de sourire."],
        ["{keyword} brille dans l‚Äôobscurit√©,", "Comme une √©toile de v√©rit√©,", "Les ombres s‚Äôeffacent sous son √©clat,", "Et le c≈ìur s‚Äôouvre √† chaque pas.", "Avec {keyword}, tout peut rena√Ætre,", "Un monde nouveau veut appara√Ætre."],
        ["Sous le ciel, {keyword} s‚Äô√©lance,", "Portant l‚Äô√¢me pleine d‚Äôesp√©rance,", "Les jours sombres s‚Äôeffacent enfin,", "Pour un futur aux doux confins.", "Oh {keyword}, lumi√®re des cieux,", "Tu rends la vie plus radieuse."],
        ["{keyword} chante dans le matin,", "Un air doux, un nouveau destin,", "Les cha√Ænes du pass√© se brisent,", "Et l‚Äô√¢me s‚Äôouvre √† la surprise.", "Avec {keyword}, je vois l‚Äôaurore,", "Un monde o√π l‚Äôespoir s‚Äô√©vapore."],
        ["Dans l‚Äô√©clat de {keyword}, je crois,", "Que demain chassera les effrois,", "Chaque r√™ve devient une flamme,", "Qui r√©chauffe le c≈ìur et l‚Äô√¢me.", "Oh {keyword}, guide des lendemains,", "Tu traces un lumineux chemin."],
        ["{keyword} est un phare dans la nuit,", "Un √©clat qui jamais ne s‚Äôenfuit,", "Les temp√™tes s‚Äôeffacent sous son aile,", "Et l‚Äôespoir rena√Æt, √©ternel.", "Avec {keyword}, tout semble possible,", "Le c≈ìur devient invincible."],
        ["Sous l‚Äôombre douce de {keyword},", "L‚Äô√¢me s‚Äô√©l√®ve, loin des haines,", "Chaque jour porte une promesse,", "Un futur plein de tendresse.", "Oh {keyword}, souffle de lumi√®re,", "Tu fais na√Ætre un monde meilleur."],
      ],
      technologie: [
        ["Dans l‚Äô√©clat de {keyword}, le futur brille,", "Des circuits dansent, l‚Äôesprit s‚Äô√©veille,", "Les donn√©es s‚Äôentrelacent en silence,", "Portant l‚Äôhomme vers l‚Äôimmense.", "Oh {keyword}, feu de l‚Äôinnovation,", "Tu sculptes la nouvelle cr√©ation."],
        ["{keyword} pulse comme un c≈ìur d‚Äôacier,", "Dans un monde o√π tout peut s‚Äô√©clairer,", "Les √©crans chantent des r√™ves nouveaux,", "Et l‚Äôavenir s‚Äôouvre en √©cho.", "Avec {keyword}, l‚Äô√¢me s‚Äôenvole,", "Vers des cieux que nul ne contr√¥le."],
        ["Sous l‚Äôombre de {keyword}, tout s‚Äôinvente,", "Des machines na√Æt une attente,", "Les codes murmurent des secrets,", "Un futur libre de regrets.", "Oh {keyword}, √©clat du progr√®s,", "Tu portes l‚Äôhomme au-del√† des faits."],
        ["{keyword} brille dans l‚Äô√®re num√©rique,", "Un phare dans un monde chim√©rique,", "Les r√©seaux tissent des liens infinis,", "Et l‚Äôesprit s‚Äôouvre √† l‚Äôamplifi.", "Avec {keyword}, tout se transforme,", "Le monde prend une nouvelle forme."],
        ["Dans le flux de {keyword}, je vois,", "Un horizon o√π tout se con√ßoit,", "Les machines dansent avec l‚Äôhumain,", "Pour un futur au doux dessein.", "Oh {keyword}, souffle du savoir,", "Tu fais na√Ætre un nouvel espoir."],
        ["{keyword} est une √©toile d‚Äôacier,", "Guidant l‚Äô√¢me dans un monde altier,", "Les algorithmes chantent en ch≈ìur,", "Un hymne au progr√®s, sans peur.", "Avec {keyword}, le temps s‚Äôacc√©l√®re,", "Pour une vie toujours plus claire."],
        ["Sous la lueur de {keyword}, l‚Äôavenir,", "S‚Äôouvre comme un livre √† venir,", "Les donn√©es dansent, libres et vives,", "Portant l‚Äôhomme vers des rives.", "Oh {keyword}, flamme de l‚Äôesprit,", "Tu rends le monde plus √©clairci."],
      ],
      liberte: [
        ["Dans l‚Äô√©clat de {keyword}, je m‚Äôenvole,", "Loin des cha√Ænes, l‚Äô√¢me s‚Äôaffole,", "Le vent porte mes r√™ves au loin,", "Vers un ciel sans aucun besoin.", "Oh {keyword}, souffle de l‚Äôinfini,", "Tu rends la vie plus √©claircie."],
        ["{keyword} chante dans l‚Äôhorizon,", "Un air libre, loin des prisons,", "Chaque pas brise une barri√®re,", "Et l‚Äô√¢me s‚Äôouvre √† la lumi√®re.", "Avec {keyword}, tout est possible,", "Le c≈ìur devient invincible."],
        ["Sous le ciel, {keyword} m‚Äôappelle,", "Vers des terres o√π rien ne chancelle,", "Les murs tombent, le c≈ìur s‚Äô√©lance,", "Dans un monde plein d‚Äôesp√©rance.", "Oh {keyword}, √©clat de l‚Äô√™tre,", "Tu fais na√Ætre un monde plus libre."],
        ["{keyword} brille comme un soleil,", "Dans la nuit, elle m‚Äô√©merveille,", "Chaque souffle est une d√©livrance,", "Chaque instant une nouvelle chance.", "Avec {keyword}, je suis vivant,", "Libre dans l‚Äô√©ternel instant."],
        ["Dans l‚Äôombre de {keyword}, je cours,", "Vers des jours sans aucun d√©tour,", "Les cha√Ænes s‚Äôeffacent dans le vent,", "Et l‚Äô√¢me s‚Äô√©l√®ve, triomphante.", "Oh {keyword}, flamme des cieux,", "Tu rends le monde plus radieux."],
        ["{keyword} est un cri dans la nuit,", "Un √©cho qui jamais ne s‚Äôenfuit,", "Les barreaux fondent sous son √©clat,", "Et le c≈ìur s‚Äôouvre √† chaque pas.", "Avec {keyword}, je suis moi-m√™me,", "Libre d‚Äôaimer, libre de l‚Äôaime."],
        ["Sous l‚Äô√©clat doux de {keyword},", "Le monde s‚Äôouvre, loin des haines,", "Chaque r√™ve devient une aile,", "Pour voler vers des terres nouvelles.", "Oh {keyword}, souffle de l‚Äô√¢me,", "Tu portes l‚Äôhomme vers la flamme."],
      ]
    };
    const adjectives = ["tendre", "√©clatant", "myst√©rieux", "serein", "ardent", "profond", "lumineux"];

    function generateDynamicPoem(keyword, domain) {
      if (!keyword) keyword = "r√™ve";
      if (!domain) domain = "amour";
      const template = poemTemplates[domain][Math.floor(Math.random() * poemTemplates[domain].length)];
      const adj = adjectives[Math.floor(Math.random() * adjectives.length)];
      const poem = template.map(line => line.replace("{keyword}", `${adj} ${keyword}`)).join("\n");
      console.log("Po√®me g√©n√©r√© :", poem);
      return poem;
    }

    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    let particles = [];
    let currentPoem = '';
    let time = 0;
    let currentAudio = null;
    let stream = null;

    function resizeCanvas() {
      canvas.width = Math.min(800, window.innerWidth * 0.9);
      canvas.height = Math.min(400, window.innerHeight * 0.6);
      drawScene();
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    function drawBackground(theme) {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      time += 0.02;
      if (theme === 'gradient') {
        const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
        gradient.addColorStop(0, '#ff6bd6');
        gradient.addColorStop(1, '#00f4ff');
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, canvas.width, canvas.height);
      } else if (theme === 'waves') {
        ctx.fillStyle = '#6bd6ff';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';
        ctx.lineWidth = 2;
        for (let y = 0; y < canvas.height; y += 20) {
          ctx.beginPath();
          for (let x = 0; x < canvas.width; x += 5) {
            const wave = Math.sin((x + time * 50) * 0.01 + y * 0.02) * 10;
            ctx.lineTo(x, y + wave);
          }
          ctx.stroke();
        }
      } else if (theme === 'stars') {
        ctx.fillStyle = '#1a1a40';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        for (let i = 0; i < 100; i++) {
          const x = Math.random() * canvas.width;
          const y = Math.random() * canvas.height;
          const radius = Math.random() * 2;
          ctx.fillStyle = `rgba(255, 255, 255, ${Math.sin(time + i) * 0.5 + 0.5})`;
          ctx.beginPath();
          ctx.arc(x, y, radius, 0, Math.PI * 2);
          ctx.fill();
        }
      } else if (theme === 'clouds') {
        ctx.fillStyle = '#f0f8ff';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        for (let i = 0; i < 10; i++) {
          ctx.fillStyle = `rgba(255, 255, 255, ${0.2 + Math.sin(time + i) * 0.1})`;
          ctx.beginPath();
          ctx.arc((i * 100 + time * 20) % canvas.width, 50 + i * 30, 50, 0, Math.PI * 2);
          ctx.fill();
        }
      } else if (theme === 'aurora') {
        ctx.fillStyle = '#0d1b2a';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        for (let i = 0; i < canvas.height; i += 10) {
          const alpha = 0.3 + Math.sin(time + i * 0.02) * 0.2;
          ctx.fillStyle = `rgba(${50 + i % 100}, ${150 + i % 100}, 255, ${alpha})`;
          ctx.fillRect(0, i, canvas.width, 10);
        }
      } else if (theme === 'fireflies') {
        ctx.fillStyle = '#1c2526';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        for (let i = 0; i < 50; i++) {
          const x = Math.random() * canvas.width;
          const y = Math.random() * canvas.height;
          const glow = Math.sin(time + i) * 0.5 + 0.5;
          ctx.fillStyle = `rgba(255, 255, 0, ${glow})`;
          ctx.beginPath();
          ctx.arc(x, y, 2, 0, Math.PI * 2);
          ctx.fill();
        }
      } else if (theme === 'rain') {
        ctx.fillStyle = '#b0c4de';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        for (let i = 0; i < 100; i++) {
          const x = Math.random() * canvas.width;
          const y = (i * 10 + time * 50) % canvas.height;
          ctx.strokeStyle = `rgba(255, 255, 255, 0.5)`;
          ctx.beginPath();
          ctx.moveTo(x, y);
          ctx.lineTo(x, y + 10);
          ctx.stroke();
        }
      } else if (theme === 'galaxy') {
        ctx.fillStyle = '#0a0a23';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = `rgba(255, 255, 255, 0.7)`;
        for (let i = 0; i < 100; i++) {
          const angle = i * 0.1 + time * 0.2;
          const radius = i * 2;
          const x = canvas.width / 2 + Math.cos(angle) * radius;
          const y = canvas.height / 2 + Math.sin(angle) * radius;
          ctx.beginPath();
          ctx.arc(x, y, 1, 0, Math.PI * 2);
          ctx.fill();
        }
      } else if (theme === 'sunset') {
        const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
        const hue = (Math.sin(time * 0.1) + 1) / 2;
        gradient.addColorStop(0, `hsl(${hue * 30 + 10}, 80%, 60%)`);
        gradient.addColorStop(1, `hsl(${hue * 30 + 40}, 80%, 40%)`);
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, canvas.width, canvas.height);
      } else if (theme === 'forest') {
        ctx.fillStyle = '#013220';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        for (let i = 0; i < canvas.width; i += 20) {
          const light = Math.sin(time + i * 0.02) * 20 + 50;
          ctx.fillStyle = `rgba(144, 238, 144, 0.3)`;
          ctx.fillRect(i, 0, 20, canvas.height * (light / 100));
        }
      }
    }

    function createParticles() {
      particles = [];
      for (let i = 0; i < 30; i++) {
        particles.push({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height,
          radius: Math.random() * 2 + 1,
          speed: Math.random() * 1 + 0.5
        });
      }
    }

    function drawParticles() {
      ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';
      particles.forEach(p => {
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
        ctx.fill();
        p.y -= p.speed;
        if (p.y < 0) p.y = canvas.height;
      });
    }

    function drawScene() {
      const theme = document.getElementById('themeSelector').value;
      drawBackground(theme);
      drawParticles();
      if (currentPoem) {
        ctx.font = `18px 'Segoe UI', Arial`;
        ctx.textAlign = 'center';
        ctx.fillStyle = ['stars', 'aurora', 'fireflies', 'galaxy', 'forest'].includes(theme) ? '#fff' : '#000';
        const lines = currentPoem.split('\n');
        const lineHeight = 22;
        const startY = canvas.height / 2 - (lines.length - 1) * lineHeight / 2;
        lines.forEach((line, i) => {
          ctx.fillText(line, canvas.width / 2, startY + i * lineHeight);
        });
      } else {
        ctx.font = '16px Arial';
        ctx.textAlign = 'center';
        ctx.fillStyle = ['stars', 'aurora', 'fireflies', 'galaxy', 'forest'].includes(theme) ? '#fff' : '#000';
        ctx.fillText("Entrez un mot-cl√© et g√©n√©rez !", canvas.width / 2, canvas.height / 2);
      }
    }

    const themeAudio = {
      gradient: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3",
      waves: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3",
      stars: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3",
      clouds: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3",
      aurora: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3",
      fireflies: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3",
      rain: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3",
      galaxy: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3",
      sunset: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3",
      forest: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3"
    };

    function playAudio(src) {
      if (currentAudio) currentAudio.pause();
      currentAudio = new Audio(src);
      currentAudio.loop = true;
      currentAudio.volume = 0.3;
      currentAudio.play().catch(() => console.log("Erreur de lecture audio"));
    }

    function generatePoem() {
      const keyword = document.getElementById('keyword').value;
      const domain = document.getElementById('domainSelector').value;
      const theme = document.getElementById('themeSelector').value;
      currentPoem = generateDynamicPoem(keyword, domain);
      localStorage.setItem('lastPoem', currentPoem);
      playAudio(themeAudio[theme]);
      drawScene();
    }

    function exportImage() {
      const link = document.createElement('a');
      link.download = 'poeme.png';
      link.href = canvas.toDataURL('image/png');
      link.click();
    }

    function sharePoem() {
      if (navigator.share) {
        navigator.share({
          title: 'Mon Po√®me Visuel',
          text: currentPoem,
          url: window.location.href
        });
      } else {
        alert('Partage non support√©.');
      }
    }

    function copyPoem() {
      if (currentPoem) {
        navigator.clipboard.writeText(currentPoem).then(() => {
          alert("Votre po√®me a bien √©t√© copi√© ü•Ä, po√®me Yann bot vous remercie üñêÔ∏è!");
        }).catch(() => {
          alert("Erreur lors de la copie.");
        });
      } else {
        alert("Aucun po√®me √† copier. G√©n√©rez un po√®me d'abord !");
      }
    }

    function savePoem() {
      html2canvas(document.querySelector('#canvas')).then(canvas => {
        const link = document.createElement('a');
        link.download = 'poeme.png';
        link.href = canvas.toDataURL();
        link.click();
      });
    }

    document.getElementById('themeSelector').addEventListener('change', (e) => {
      document.body.className = `theme-${e.target.value}`;
      playAudio(themeAudio[e.target.value]);
      drawScene();
    });

    function toggleHighContrast() {
      document.body.classList.toggle('high-contrast');
      drawScene();
    }

    function openProfileModal() {
      const modal = document.getElementById('profileModal');
      modal.style.display = 'flex';
      const savedName = localStorage.getItem('profileName') || '';
      const savedPhoto = localStorage.getItem('profilePhoto') || '';
      document.getElementById('profileName').value = savedName;
      const preview = document.getElementById('profilePreview');
      if (savedPhoto) {
        preview.src = savedPhoto;
        preview.style.display = 'block';
      }
      updateProfileDisplay();
      if (document.getElementById('drawer').classList.contains('open')) {
        toggleDrawer();
      }
    }

    function closeProfileModal() {
      const modal = document.getElementById('profileModal');
      modal.style.display = 'none';
      if (stream) {
        stream.getTracks().forEach(track => track.stop());
        document.getElementById('cameraStream').style.display = 'none';
      }
    }

    document.getElementById('profilePhoto').addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = () => {
          const preview = document.getElementById('profilePreview');
          preview.src = reader.result;
          preview.style.display = 'block';
        };
        reader.readAsDataDataURL(file);
      }
    });

    function takePhoto() {
      const video = document.getElementById('cameraStream');
      const canvas = document.getElementById('photoCanvas');
      const preview = document.getElementById('profilePreview');
      navigator.mediaDevices.getUserMedia({ video: true })
        .then((mediaStream) => {
          stream = mediaStream;
          video.srcObject = stream;
          video.style.display = 'block';
          video.play();
          setTimeout(() => {
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            canvas.getContext('2d').drawImage(video, 0, 0);
            preview.src = canvas.toDataURL('image/png');
            preview.style.display = 'block';
            stream.getTracks().forEach(track => track.stop());
            video.style.display = 'none';
          }, 3000);
        })
        .catch(() => {
          alert('Cam√©ra non disponible. Essayez d‚Äôuploader une photo.');
        });
    }

    function saveProfile() {
      const name = document.getElementById('profileName').value;
      const photo = document.getElementById('profilePreview').src;
      if (name) {
        localStorage.setItem('profileName', name);
      }
      if (photo && photo !== window.location.href) {
        localStorage.setItem('profilePhoto', photo);
      }
      updateProfileDisplay();
      closeProfileModal();
      alert('Profil sauvegard√© !');
    }

    function updateProfileDisplay() {
      const name = localStorage.getItem('profileName') || '';
      const photo = localStorage.getItem('profilePhoto') || '';
      const display = document.getElementById('profileDisplay');
      if (name || photo) {
        display.innerHTML = photo ? `<img src="${photo}" alt="Photo de profil">` : '';
        display.innerHTML += name ? `Bienvenue, ${name} | ` : '';
      } else {
        display.innerHTML = '';
      }
    }

    function animate() {
      drawScene();
      requestAnimationFrame(animate);
    }

    createParticles();
    drawScene();
    animate();
    updateProfileDisplay();

    document.querySelectorAll('button, input, select').forEach(el => {
      el.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') el.click();
      });
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        if (document.getElementById('profileModal').style.display === 'flex') {
          closeProfileModal();
        } else if (document.getElementById('infoModal').style.display === 'flex') {
          closeInfoModal();
        } else if (document.getElementById('drawer').classList.contains('open')) {
          toggleDrawer();
        }
      }
    });
  </script>
</body>
    </html>
